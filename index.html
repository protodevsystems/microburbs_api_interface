<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microburbs - Professional Property Intelligence</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Leaflet CSS and JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Leaflet Marker Cluster -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    
    <!-- Leaflet Heat Map -->
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    
    <!-- Leaflet Draw -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css" />
    <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="brand">
                <i class="fas fa-building"></i>
                <span>Microburbs</span>
                <span class="badge">PRO</span>
            </div>
            <div class="nav-links">
                <a href="#" class="active">Properties</a>
                <a href="#">Market Insights</a>
                <a href="#">Reports</a>
            </div>
        </div>
    </nav>

    <div class="hero-section">
        <div class="hero-content">
            <h1>Professional Property Intelligence</h1>
            <p>Access comprehensive property data and market insights for informed investment decisions</p>
        </div>
    </div>

    <div class="main-container">
        <div class="search-panel">
            <div class="search-header">
                <h2>Search Properties</h2>
                <p>Enter a suburb to view available properties and market data</p>
            </div>
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input 
                    type="text" 
                    id="suburbInput" 
                    placeholder="Enter suburb name (e.g., Belmont North, Newcastle, Lake Macquarie)" 
                    value="Belmont North"
                />
                <button id="searchBtn" onclick="fetchSuburbData()">
                    <span id="btnText">Search Properties</span>
                    <span id="btnLoader" class="loader" style="display: none;"></span>
                </button>
            </div>
            <p class="search-note">
                <i class="fas fa-info-circle"></i>
                <strong>Note:</strong> API access is limited to certain suburbs in NSW. If you receive an authorization error, try a different suburb.
            </p>
        </div>

        <div id="results" class="results-container" style="display: none;">
            <div class="results-header">
                <div class="results-info">
                    <h2><span id="suburbName"></span></h2>
                    <p id="resultCount"></p>
                </div>
            <div class="results-controls">
                <div class="export-dropdown">
                    <button class="export-btn" onclick="toggleExportMenu()">
                        <i class="fas fa-download"></i>
                        <span>Export Data</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div id="exportMenu" class="export-menu" style="display: none;">
                        <button onclick="exportData('csv-all')">
                            <i class="fas fa-file-csv"></i>
                            Export All (CSV)
                        </button>
                        <button onclick="exportData('excel-all')">
                            <i class="fas fa-file-excel"></i>
                            Export All (Excel)
                        </button>
                        <button onclick="exportData('csv-properties')">
                            <i class="fas fa-home"></i>
                            Properties (CSV)
                        </button>
                        <button onclick="exportData('excel-properties')">
                            <i class="fas fa-home"></i>
                            Properties (Excel)
                        </button>
                        <button onclick="exportData('csv-metrics')">
                            <i class="fas fa-chart-line"></i>
                            Metrics (CSV)
                        </button>
                        <button onclick="exportData('excel-metrics')">
                            <i class="fas fa-chart-line"></i>
                            Metrics (Excel)
                        </button>
                        <button onclick="exportData('json')">
                            <i class="fas fa-code"></i>
                            Complete Report (JSON)
                        </button>
                    </div>
                </div>
                <select id="sortSelect" onchange="sortProperties()">
                    <option value="price-high">Price: High to Low</option>
                    <option value="price-low">Price: Low to High</option>
                    <option value="bedrooms">Bedrooms</option>
                    <option value="newest">Newest Listings</option>
                </select>
                <button class="view-toggle" onclick="toggleView()" title="Toggle view">
                    <i class="fas fa-th-large"></i>
                </button>
            </div>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="switchTab('property-finder')">
                    <i class="fas fa-home"></i>
                    Property Finder
                </button>
                <button class="tab-btn" onclick="switchTab('technical-insights')">
                    <i class="fas fa-chart-bar"></i>
                    Technical Insights
                </button>
                <button class="tab-btn" onclick="switchTab('map-view')">
                    <i class="fas fa-map-marked-alt"></i>
                    Map View
                </button>
                <button class="tab-btn" onclick="switchTab('playground')">
                    <i class="fas fa-gamepad"></i>
                    Playground
                </button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Property Finder Tab (Original Layout) -->
                <div id="property-finder-tab" class="tab-panel active">
                    <!-- Investor Dashboard Section -->
            <div class="investor-dashboard">
                <div class="dashboard-header">
                    <h3><i class="fas fa-chart-line"></i> Investment Intelligence Dashboard</h3>
                    <p>Key metrics for informed investment decisions</p>
                </div>

                <!-- Financial Performance Metrics -->
                <div class="metrics-section">
                    <h4 class="section-title">
                        <i class="fas fa-dollar-sign"></i> Financial Performance
                    </h4>
                    <div id="financialMetrics" class="metrics-grid"></div>
                </div>

                <!-- Market Activity Metrics -->
                <div class="metrics-section">
                    <h4 class="section-title">
                        <i class="fas fa-chart-bar"></i> Market Activity
                    </h4>
                    <div id="marketActivityMetrics" class="metrics-grid"></div>
                </div>

                <!-- Location & Demographics -->
                <div class="metrics-section">
                    <h4 class="section-title">
                        <i class="fas fa-map-marked-alt"></i> Location & Demographics
                    </h4>
                    <div id="locationMetrics" class="metrics-grid"></div>
                </div>

                <!-- Risk & Opportunity Indicators -->
                <div class="metrics-section">
                    <h4 class="section-title">
                        <i class="fas fa-shield-alt"></i> Risk & Opportunity
                    </h4>
                    <div id="riskMetrics" class="metrics-grid"></div>
                </div>
            </div>

            <!-- Basic Market Stats -->
            <div class="basic-stats-section">
                <h3><i class="fas fa-home"></i> Current Listings Overview</h3>
                <div id="marketStats" class="market-stats"></div>
            </div>

            <!-- Property Listings -->
            <div class="properties-section">
                <h3><i class="fas fa-building"></i> Available Properties</h3>
                <div id="propertyGrid" class="property-grid"></div>
            </div>
                </div>
                <!-- End Property Finder Tab -->

                <!-- Technical Insights Tab -->
                <div id="technical-insights-tab" class="tab-panel">
                    <div class="technical-insights-container">
                        
                        <!-- Investment Opportunity Radar -->
                        <div class="insights-section highlight-section">
                            <h3><i class="fas fa-bullseye"></i> Investment Opportunity Scores</h3>
                            <p class="section-description">Properties ranked by multi-factor investment potential</p>
                            <div id="investmentScores" class="opportunity-grid"></div>
                        </div>

                        <!-- Value Analysis -->
                        <div class="insights-section highlight-section">
                            <h3><i class="fas fa-dollar-sign"></i> Value per Square Meter Analysis</h3>
                            <p class="section-description">Identify the best value properties in the market</p>
                            <canvas id="valueAnalysisChart"></canvas>
                            <div id="valueMetrics" class="value-metrics-grid"></div>
                        </div>

                        <!-- Outlier Detection -->
                        <div class="insights-section highlight-section">
                            <h3><i class="fas fa-gem"></i> Outlier Detection & Opportunities</h3>
                            <p class="section-description">Statistically identify undervalued gems and overpriced listings</p>
                            <div id="outlierAnalysis" class="outlier-container"></div>
                        </div>

                        <!-- ROI Projections -->
                        <div class="insights-section highlight-section">
                            <h3><i class="fas fa-chart-line"></i> ROI Projection Calculator</h3>
                            <p class="section-description">Estimated returns based on market trends and property characteristics</p>
                            <div id="roiCalculator" class="roi-grid"></div>
                        </div>

                        <!-- Top Investment Picks -->
                        <div class="insights-section highlight-section">
                            <h3><i class="fas fa-trophy"></i> Top Investment Picks</h3>
                            <p class="section-description">Data-driven recommendations based on comprehensive analysis</p>
                            <div id="topPicks" class="top-picks-container"></div>
                        </div>

                        <!-- Statistical Overview -->
                        <div class="insights-section">
                            <h3><i class="fas fa-calculator"></i> Statistical Analysis</h3>
                            <div id="statisticalAnalysis" class="stats-grid"></div>
                        </div>

                        <!-- Price Distribution Chart -->
                        <div class="insights-section">
                            <h3><i class="fas fa-chart-area"></i> Price Distribution</h3>
                            <canvas id="priceDistributionChart"></canvas>
                        </div>

                        <!-- Property Characteristics Analysis -->
                        <div class="insights-section">
                            <h3><i class="fas fa-th"></i> Property Characteristics Matrix</h3>
                            <div id="characteristicsMatrix" class="matrix-grid"></div>
                        </div>

                        <!-- Correlation Analysis -->
                        <div class="insights-section">
                            <h3><i class="fas fa-project-diagram"></i> Correlation Analysis</h3>
                            <canvas id="correlationChart"></canvas>
                        </div>

                        <!-- Market Segmentation -->
                        <div class="insights-section">
                            <h3><i class="fas fa-chart-pie"></i> Market Segmentation</h3>
                            <canvas id="segmentationChart"></canvas>
                        </div>

                        <!-- Data Quality Report -->
                        <div class="insights-section">
                            <h3><i class="fas fa-clipboard-check"></i> Data Quality Report</h3>
                            <div id="dataQualityReport" class="quality-report"></div>
                        </div>

                        <!-- Raw Data Table -->
                        <div class="insights-section">
                            <h3><i class="fas fa-table"></i> Raw Data Table</h3>
                            <div class="table-controls">
                                <input type="text" id="dataTableSearch" placeholder="Search table..." class="table-search">
                                <button onclick="exportTableData()" class="btn-secondary">
                                    <i class="fas fa-download"></i> Export Table
                                </button>
                            </div>
                            <div id="rawDataTable" class="data-table-container"></div>
                        </div>
                    </div>
                </div>
                <!-- End Technical Insights Tab -->

                <!-- Map View Tab -->
                <div id="map-view-tab" class="tab-panel">
                    <div class="map-view-container">
                        
                        <!-- Left Sidebar - Filters -->
                        <div class="map-sidebar-left">
                            <div class="sidebar-header">
                                <h3><i class="fas fa-filter"></i> Filters</h3>
                            </div>
                            
                            <div class="filter-section">
                                <label class="filter-label">Price Range</label>
                                <div class="price-range-container">
                                    <input type="range" id="minPriceSlider" class="price-slider" min="0" max="5000000" step="50000" value="0">
                                    <input type="range" id="maxPriceSlider" class="price-slider" min="0" max="5000000" step="50000" value="5000000">
                                    <div class="price-labels">
                                        <span id="minPriceLabel">$0</span>
                                        <span id="maxPriceLabel">$5M+</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="filter-section">
                                <label class="filter-label">Property Type</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" class="property-type-filter" value="House" checked>
                                        <span>House</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" class="property-type-filter" value="Unit" checked>
                                        <span>Unit</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" class="property-type-filter" value="Townhouse" checked>
                                        <span>Townhouse</span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" class="property-type-filter" value="Land" checked>
                                        <span>Land</span>
                                    </label>
                                </div>
                            </div>
                            
                            <button class="btn-reset-filters" onclick="resetMapFilters()">
                                <i class="fas fa-redo"></i>
                                Reset Filters
                            </button>
                            
                            <div class="map-legend">
                                <h4>Price Legend</h4>
                                <div class="legend-item">
                                    <span class="legend-marker legend-green"></span>
                                    <span>Low Price</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-marker legend-orange"></span>
                                    <span>Medium Price</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-marker legend-red"></span>
                                    <span>High Price</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Map Container -->
                        <div id="propertyMap" class="map-container"></div>
                        
                        <!-- Floating Map Controls -->
                        <div class="map-controls">
                            <button class="map-control-btn" onclick="fitAllProperties()" title="Show all properties">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="map-control-btn" id="toggleClusterBtn" onclick="toggleClustering()" title="Toggle clustering">
                                <i class="fas fa-layer-group"></i>
                            </button>
                            <button class="map-control-btn" id="toggleHeatBtn" onclick="toggleHeatMap()" title="Toggle heat map">
                                <i class="fas fa-fire"></i>
                            </button>
                            <button class="map-control-btn" id="drawRadiusBtn" onclick="enableRadiusDraw()" title="Draw search radius">
                                <i class="fas fa-circle-notch"></i>
                            </button>
                            <div class="property-count-badge" id="mapPropertyCount">
                                <i class="fas fa-home"></i>
                                <span id="visiblePropertyCount">0</span>
                            </div>
                        </div>
                        
                        <!-- Right Sidebar - Property Comparison -->
                        <div class="map-sidebar-right">
                            <div class="sidebar-header">
                                <h3><i class="fas fa-balance-scale"></i> Compare Properties</h3>
                                <button class="btn-clear-comparison" onclick="clearComparison()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div id="comparisonContainer" class="comparison-container">
                                <div class="comparison-placeholder">
                                    <i class="fas fa-mouse-pointer"></i>
                                    <p>Click on markers to compare properties</p>
                                    <p class="small-text">Select up to 2 properties</p>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                <!-- End Map View Tab -->

                <!-- Playground Tab -->
                <div id="playground-tab" class="tab-panel">
                    <div class="playground-container">
                        
                        <!-- Sub-Tab Navigation -->
                        <div class="playground-subtabs">
                            <button class="playground-subtab-btn active" onclick="switchPlaygroundFeature('tinder')">
                                <i class="fas fa-heart"></i>
                                Property Tinder
                            </button>
                            <button class="playground-subtab-btn" onclick="switchPlaygroundFeature('timeline')">
                                <i class="fas fa-chart-line"></i>
                                Timeline View
                            </button>
                            <button class="playground-subtab-btn" onclick="switchPlaygroundFeature('calculator')">
                                <i class="fas fa-calculator"></i>
                                Investment Calculator
                            </button>
                            <button class="playground-subtab-btn" onclick="switchPlaygroundFeature('comparison')">
                                <i class="fas fa-balance-scale"></i>
                                Property Comparison
                            </button>
                            <button class="playground-subtab-btn" onclick="switchPlaygroundFeature('battle')">
                                <i class="fas fa-trophy"></i>
                                Battle Royale
                            </button>
                            <button class="playground-subtab-btn" onclick="switchPlaygroundFeature('scores')">
                                <i class="fas fa-chart-bar"></i>
                                Investment Scores
                            </button>
                            <button class="playground-subtab-btn" disabled style="opacity: 0.5;">
                                <i class="fas fa-folder"></i>
                                Portfolio
                                <span style="font-size: 0.7em; opacity: 0.7;"> (Coming Soon)</span>
                            </button>
                        </div>

                        <!-- Property Tinder Sub-Panel -->
                        <div id="tinder-panel" class="playground-subpanel active">
                        
                        <!-- Header Section -->
                        <div class="playground-header">
                            <div class="playground-title">
                                <h2><i class="fas fa-heart"></i> Property Tinder</h2>
                                <p class="playground-subtitle">Swipe right to like, left to pass</p>
                            </div>
                            <div class="playground-stats">
                                <div class="stat-badge">
                                    <i class="fas fa-heart"></i>
                                    <span id="likedCount">0</span> Liked
                                </div>
                                <div class="stat-badge">
                                    <i class="fas fa-times"></i>
                                    <span id="passedCount">0</span> Passed
                                </div>
                            </div>
                        </div>

                        <!-- Swipe Interface -->
                        <div class="swipe-container">
                            <div class="swipe-stack" id="swipeStack">
                                <!-- Cards will be dynamically inserted here -->
                                <div class="swipe-card-placeholder">
                                    <i class="fas fa-search"></i>
                                    <h3>Search for properties first</h3>
                                    <p>Use the search panel above to load properties</p>
                                </div>
                            </div>

                            <!-- Swipe Action Indicators -->
                            <div class="swipe-indicator swipe-indicator-left" id="swipeIndicatorLeft">
                                <i class="fas fa-times"></i>
                                <span>PASS</span>
                            </div>
                            <div class="swipe-indicator swipe-indicator-right" id="swipeIndicatorRight">
                                <i class="fas fa-heart"></i>
                                <span>LIKE</span>
                            </div>

                            <!-- Swipe Buttons -->
                            <div class="swipe-buttons">
                                <button class="swipe-btn swipe-btn-pass" onclick="swipeLeft()" title="Pass (←)">
                                    <i class="fas fa-times"></i>
                                </button>
                                <button class="swipe-btn swipe-btn-undo" onclick="undoSwipe()" title="Undo (↑)">
                                    <i class="fas fa-undo"></i>
                                </button>
                                <button class="swipe-btn swipe-btn-like" onclick="swipeRight()" title="Like (→)">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Liked Properties Panel -->
                        <div class="liked-properties-panel">
                            <div class="panel-header">
                                <h3><i class="fas fa-heart"></i> Your Liked Properties</h3>
                                <button class="btn-toggle-panel" onclick="toggleLikedPanel()">
                                    <i class="fas fa-chevron-up"></i>
                                </button>
                            </div>
                            <div class="liked-properties-grid" id="likedPropertiesGrid">
                                <div class="no-liked-placeholder">
                                    <i class="fas fa-heart-broken"></i>
                                    <p>No liked properties yet</p>
                                    <p class="small-text">Start swiping to build your collection!</p>
                                </div>
                            </div>
                        </div>

                        <!-- Preference Insights -->
                        <div class="preference-insights" id="preferenceInsights" style="display: none;">
                            <div class="insights-header">
                                <h3><i class="fas fa-brain"></i> Your Preference Profile</h3>
                                <p>Based on your swipe patterns, here's what you prefer:</p>
                            </div>
                            <div class="insights-grid" id="insightsGrid">
                                <!-- Dynamic preference insights will be inserted here -->
                            </div>
                        </div>

                        </div>
                        <!-- End Property Tinder Sub-Panel -->

                        <!-- Timeline View Sub-Panel -->
                        <div id="timeline-panel" class="playground-subpanel">
                            
                            <!-- Timeline Header -->
                            <div class="timeline-header">
                                <div class="timeline-title">
                                    <h2><i class="fas fa-chart-line"></i> Property Timeline</h2>
                                    <p class="timeline-subtitle">Visualize listing history and market activity over time</p>
                                </div>
                                <div class="timeline-controls">
                                    <button class="timeline-control-btn" onclick="playTimeline()" id="playTimelineBtn">
                                        <i class="fas fa-play"></i> Play
                                    </button>
                                    <button class="timeline-control-btn" onclick="resetTimeline()">
                                        <i class="fas fa-redo"></i> Reset
                                    </button>
                                </div>
                            </div>

                            <!-- Timeline Stats -->
                            <div class="timeline-stats">
                                <div class="timeline-stat-card">
                                    <i class="fas fa-calendar-alt"></i>
                                    <div class="timeline-stat-content">
                                        <div class="timeline-stat-value" id="timelineEarliestDate">-</div>
                                        <div class="timeline-stat-label">Earliest Listing</div>
                                    </div>
                                </div>
                                <div class="timeline-stat-card">
                                    <i class="fas fa-calendar-check"></i>
                                    <div class="timeline-stat-content">
                                        <div class="timeline-stat-value" id="timelineLatestDate">-</div>
                                        <div class="timeline-stat-label">Latest Listing</div>
                                    </div>
                                </div>
                                <div class="timeline-stat-card">
                                    <i class="fas fa-clock"></i>
                                    <div class="timeline-stat-content">
                                        <div class="timeline-stat-value" id="timelineAvgDays">-</div>
                                        <div class="timeline-stat-label">Avg Days on Market</div>
                                    </div>
                                </div>
                                <div class="timeline-stat-card">
                                    <i class="fas fa-home"></i>
                                    <div class="timeline-stat-content">
                                        <div class="timeline-stat-value" id="timelineActiveCount">0</div>
                                        <div class="timeline-stat-label">Currently Showing</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Timeline Visualization -->
                            <div class="timeline-visualization">
                                <canvas id="timelineChart" style="width: 100%; height: 400px;"></canvas>
                            </div>

                            <!-- Timeline Slider -->
                            <div class="timeline-slider-container">
                                <div class="timeline-slider-label">
                                    <span>Scrub through time</span>
                                    <span id="timelineCurrentDate" class="timeline-current-date">-</span>
                                </div>
                                <input type="range" id="timelineSlider" class="timeline-slider" min="0" max="100" value="100" />
                                <div class="timeline-slider-markers">
                                    <span id="timelineStartLabel">-</span>
                                    <span id="timelineEndLabel">-</span>
                                </div>
                            </div>

                            <!-- Timeline Properties Grid -->
                            <div class="timeline-properties-section">
                                <div class="timeline-properties-header">
                                    <h3>Properties in Current View</h3>
                                    <div class="timeline-sort">
                                        <label>Sort by:</label>
                                        <select id="timelineSortSelect" onchange="sortTimelineProperties()">
                                            <option value="date-new">Newest First</option>
                                            <option value="date-old">Oldest First</option>
                                            <option value="price-high">Price: High to Low</option>
                                            <option value="price-low">Price: Low to High</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="timeline-properties-grid" id="timelinePropertiesGrid">
                                    <div class="timeline-placeholder">
                                        <i class="fas fa-search"></i>
                                        <p>Search for properties to see the timeline</p>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- End Timeline View Sub-Panel -->

                        <!-- Investment Calculator Sub-Panel -->
                        <div id="calculator-panel" class="playground-subpanel">
                            
                            <!-- Calculator Header -->
                            <div class="calculator-header">
                                <div class="calculator-title">
                                    <h2><i class="fas fa-calculator"></i> Investment Calculator</h2>
                                    <p class="calculator-subtitle">Calculate mortgage payments, ROI, cash flow, and affordability</p>
                                </div>
                            </div>

                            <!-- Property Selector -->
                            <div class="calculator-property-selector">
                                <label for="calculatorPropertySelect">
                                    <i class="fas fa-home"></i> Select a property to analyze:
                                </label>
                                <select id="calculatorPropertySelect" onchange="loadPropertyToCalculator()">
                                    <option value="">-- Choose a property --</option>
                                </select>
                                <button class="btn-custom-property" onclick="enableCustomProperty()">
                                    <i class="fas fa-edit"></i> Enter Custom Values
                                </button>
                            </div>

                            <!-- Calculator Tabs -->
                            <div class="calculator-tabs">
                                <button class="calculator-tab-btn active" onclick="switchCalculatorMode('mortgage')">
                                    <i class="fas fa-home-lg-alt"></i>
                                    Mortgage Calculator
                                </button>
                                <button class="calculator-tab-btn" onclick="switchCalculatorMode('roi')">
                                    <i class="fas fa-chart-line"></i>
                                    ROI Scenarios
                                </button>
                                <button class="calculator-tab-btn" onclick="switchCalculatorMode('cashflow')">
                                    <i class="fas fa-money-bill-wave"></i>
                                    Cash Flow
                                </button>
                                <button class="calculator-tab-btn" onclick="switchCalculatorMode('affordability')">
                                    <i class="fas fa-hand-holding-usd"></i>
                                    Affordability
                                </button>
                            </div>

                            <!-- Mortgage Calculator Mode -->
                            <div id="mortgage-mode" class="calculator-mode active">
                                <div class="calculator-grid">
                                    <!-- Left: Inputs -->
                                    <div class="calculator-inputs">
                                        <h3>Loan Details</h3>
                                        
                                        <div class="calculator-input-group">
                                            <label>Property Price</label>
                                            <div class="input-with-icon">
                                                <span class="input-icon">$</span>
                                                <input type="number" id="mortgagePrice" value="1000000" min="0" step="10000" oninput="calculateMortgage()">
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Deposit (%)</label>
                                            <input type="range" id="mortgageDeposit" value="20" min="5" max="50" step="5" oninput="updateDepositDisplay(); calculateMortgage()">
                                            <div class="range-display">
                                                <span id="depositPercentDisplay">20%</span>
                                                <span id="depositAmountDisplay">$200,000</span>
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Interest Rate (%)</label>
                                            <input type="range" id="mortgageRate" value="6.5" min="2" max="12" step="0.1" oninput="updateRateDisplay(); calculateMortgage()">
                                            <div class="range-display">
                                                <span id="rateDisplay">6.5%</span>
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Loan Term (years)</label>
                                            <input type="range" id="mortgageTerm" value="30" min="5" max="30" step="5" oninput="updateTermDisplay(); calculateMortgage()">
                                            <div class="range-display">
                                                <span id="termDisplay">30 years</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Right: Results -->
                                    <div class="calculator-results">
                                        <h3>Monthly Breakdown</h3>
                                        
                                        <div class="result-card highlight">
                                            <div class="result-label">Monthly Payment</div>
                                            <div class="result-value" id="monthlyPayment">$0</div>
                                        </div>

                                        <div class="result-grid">
                                            <div class="result-card">
                                                <div class="result-label">Loan Amount</div>
                                                <div class="result-value" id="loanAmount">$0</div>
                                            </div>
                                            <div class="result-card">
                                                <div class="result-label">Total Interest</div>
                                                <div class="result-value" id="totalInterest">$0</div>
                                            </div>
                                            <div class="result-card">
                                                <div class="result-label">Total Repayment</div>
                                                <div class="result-value" id="totalRepayment">$0</div>
                                            </div>
                                        </div>

                                        <canvas id="mortgageChart" style="margin-top: 2rem; height: 250px;"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- ROI Scenarios Mode -->
                            <div id="roi-mode" class="calculator-mode">
                                <div class="roi-container">
                                    <div class="calculator-inputs">
                                        <h3>Investment Parameters</h3>
                                        
                                        <div class="calculator-input-group">
                                            <label>Purchase Price</label>
                                            <div class="input-with-icon">
                                                <span class="input-icon">$</span>
                                                <input type="number" id="roiPrice" value="1000000" min="0" step="10000" oninput="calculateROI()">
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Annual Appreciation (%)</label>
                                            <input type="range" id="roiAppreciation" value="5" min="0" max="15" step="0.5" oninput="updateAppreciationDisplay(); calculateROI()">
                                            <div class="range-display">
                                                <span id="appreciationDisplay">5%</span>
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Annual Rental Yield (%)</label>
                                            <input type="range" id="roiYield" value="4" min="0" max="10" step="0.5" oninput="updateYieldDisplay(); calculateROI()">
                                            <div class="range-display">
                                                <span id="yieldDisplay">4%</span>
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Investment Timeframe (years)</label>
                                            <input type="range" id="roiTimeframe" value="10" min="1" max="30" step="1" oninput="updateTimeframeDisplay(); calculateROI()">
                                            <div class="range-display">
                                                <span id="timeframeDisplay">10 years</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="roi-results">
                                        <h3>Projected Returns</h3>
                                        <div class="scenario-comparison">
                                            <div class="scenario-card best">
                                                <div class="scenario-header">
                                                    <i class="fas fa-chart-line"></i>
                                                    <span>Optimistic</span>
                                                </div>
                                                <div class="scenario-value" id="roiOptimistic">$0</div>
                                                <div class="scenario-roi" id="roiOptimisticPercent">0%</div>
                                                <div class="scenario-detail">High growth market</div>
                                            </div>

                                            <div class="scenario-card moderate">
                                                <div class="scenario-header">
                                                    <i class="fas fa-balance-scale"></i>
                                                    <span>Realistic</span>
                                                </div>
                                                <div class="scenario-value" id="roiRealistic">$0</div>
                                                <div class="scenario-roi" id="roiRealisticPercent">0%</div>
                                                <div class="scenario-detail">Expected market conditions</div>
                                            </div>

                                            <div class="scenario-card conservative">
                                                <div class="scenario-header">
                                                    <i class="fas fa-shield-alt"></i>
                                                    <span>Conservative</span>
                                                </div>
                                                <div class="scenario-value" id="roiConservative">$0</div>
                                                <div class="scenario-roi" id="roiConservativePercent">0%</div>
                                                <div class="scenario-detail">Slow market growth</div>
                                            </div>
                                        </div>

                                        <canvas id="roiChart" style="margin-top: 2rem; height: 300px;"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- Cash Flow Mode -->
                            <div id="cashflow-mode" class="calculator-mode">
                                <div class="calculator-grid">
                                    <div class="calculator-inputs">
                                        <h3>Income & Expenses</h3>
                                        
                                        <div class="cashflow-section">
                                            <h4><i class="fas fa-arrow-down" style="color: #10b981;"></i> Income</h4>
                                            <div class="calculator-input-group">
                                                <label>Weekly Rent</label>
                                                <div class="input-with-icon">
                                                    <span class="input-icon">$</span>
                                                    <input type="number" id="weeklyRent" value="800" min="0" step="10" oninput="calculateCashFlow()">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="cashflow-section">
                                            <h4><i class="fas fa-arrow-up" style="color: #ef4444;"></i> Expenses</h4>
                                            <div class="calculator-input-group">
                                                <label>Mortgage Payment (monthly)</label>
                                                <div class="input-with-icon">
                                                    <span class="input-icon">$</span>
                                                    <input type="number" id="mortgagePayment" value="5000" min="0" step="100" oninput="calculateCashFlow()">
                                                </div>
                                            </div>

                                            <div class="calculator-input-group">
                                                <label>Council Rates (annual)</label>
                                                <div class="input-with-icon">
                                                    <span class="input-icon">$</span>
                                                    <input type="number" id="councilRates" value="2500" min="0" step="100" oninput="calculateCashFlow()">
                                                </div>
                                            </div>

                                            <div class="calculator-input-group">
                                                <label>Strata/Body Corp (quarterly)</label>
                                                <div class="input-with-icon">
                                                    <span class="input-icon">$</span>
                                                    <input type="number" id="strataFees" value="0" min="0" step="100" oninput="calculateCashFlow()">
                                                </div>
                                            </div>

                                            <div class="calculator-input-group">
                                                <label>Insurance (annual)</label>
                                                <div class="input-with-icon">
                                                    <span class="input-icon">$</span>
                                                    <input type="number" id="insurance" value="1200" min="0" step="100" oninput="calculateCashFlow()">
                                                </div>
                                            </div>

                                            <div class="calculator-input-group">
                                                <label>Maintenance (annual)</label>
                                                <div class="input-with-icon">
                                                    <span class="input-icon">$</span>
                                                    <input type="number" id="maintenance" value="2000" min="0" step="100" oninput="calculateCashFlow()">
                                                </div>
                                            </div>

                                            <div class="calculator-input-group">
                                                <label>Property Management (%)</label>
                                                <input type="range" id="managementFee" value="7" min="0" max="15" step="0.5" oninput="updateManagementDisplay(); calculateCashFlow()">
                                                <div class="range-display">
                                                    <span id="managementDisplay">7%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="calculator-results">
                                        <h3>Cash Flow Analysis</h3>
                                        
                                        <div class="result-card highlight">
                                            <div class="result-label">Net Cash Flow (Weekly)</div>
                                            <div class="result-value" id="weeklyCashFlow">$0</div>
                                        </div>

                                        <div class="result-grid">
                                            <div class="result-card">
                                                <div class="result-label">Annual Income</div>
                                                <div class="result-value positive" id="annualIncome">$0</div>
                                            </div>
                                            <div class="result-card">
                                                <div class="result-label">Annual Expenses</div>
                                                <div class="result-value negative" id="annualExpenses">$0</div>
                                            </div>
                                            <div class="result-card">
                                                <div class="result-label">Net Annual</div>
                                                <div class="result-value" id="annualCashFlow">$0</div>
                                            </div>
                                        </div>

                                        <div class="cashflow-status" id="cashflowStatus">
                                            <i class="fas fa-info-circle"></i>
                                            <span>Calculate to see if this is cashflow positive</span>
                                        </div>

                                        <canvas id="cashflowChart" style="margin-top: 2rem; height: 250px;"></canvas>
                                    </div>
                                </div>
                            </div>

                            <!-- Affordability Mode -->
                            <div id="affordability-mode" class="calculator-mode">
                                <div class="calculator-grid">
                                    <div class="calculator-inputs">
                                        <h3>Your Financial Situation</h3>
                                        
                                        <div class="calculator-input-group">
                                            <label>Annual Household Income</label>
                                            <div class="input-with-icon">
                                                <span class="input-icon">$</span>
                                                <input type="number" id="householdIncome" value="150000" min="0" step="5000" oninput="calculateAffordability()">
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Available Deposit</label>
                                            <div class="input-with-icon">
                                                <span class="input-icon">$</span>
                                                <input type="number" id="availableDeposit" value="200000" min="0" step="10000" oninput="calculateAffordability()">
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Monthly Expenses</label>
                                            <div class="input-with-icon">
                                                <span class="input-icon">$</span>
                                                <input type="number" id="monthlyExpenses" value="4000" min="0" step="500" oninput="calculateAffordability()">
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Other Debts (monthly)</label>
                                            <div class="input-with-icon">
                                                <span class="input-icon">$</span>
                                                <input type="number" id="monthlyDebts" value="0" min="0" step="100" oninput="calculateAffordability()">
                                            </div>
                                        </div>

                                        <div class="calculator-input-group">
                                            <label>Property Price Target</label>
                                            <div class="input-with-icon">
                                                <span class="input-icon">$</span>
                                                <input type="number" id="targetPrice" value="1000000" min="0" step="10000" oninput="calculateAffordability()">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="calculator-results">
                                        <h3>Affordability Assessment</h3>
                                        
                                        <div class="affordability-verdict" id="affordabilityVerdict">
                                            <div class="verdict-icon">
                                                <i class="fas fa-question-circle"></i>
                                            </div>
                                            <div class="verdict-text">
                                                <h4>Calculate to see if you can afford this</h4>
                                                <p>We'll assess based on lending criteria</p>
                                            </div>
                                        </div>

                                        <div class="result-grid">
                                            <div class="result-card">
                                                <div class="result-label">Max Borrowing Capacity</div>
                                                <div class="result-value" id="maxBorrowing">$0</div>
                                            </div>
                                            <div class="result-card">
                                                <div class="result-label">Max Property Price</div>
                                                <div class="result-value" id="maxProperty">$0</div>
                                            </div>
                                            <div class="result-card">
                                                <div class="result-label">Monthly Commitment</div>
                                                <div class="result-value" id="monthlyCommitment">$0</div>
                                            </div>
                                            <div class="result-card">
                                                <div class="result-label">Debt-to-Income Ratio</div>
                                                <div class="result-value" id="debtToIncome">0%</div>
                                            </div>
                                        </div>

                                        <div class="affordability-tips">
                                            <h4><i class="fas fa-lightbulb"></i> Tips to Improve Affordability</h4>
                                            <ul id="affordabilityTips">
                                                <li>Calculate your financial position to see personalized tips</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- End Investment Calculator Sub-Panel -->

                        <!-- Property Comparison Matrix Sub-Panel -->
                        <div id="comparison-panel" class="playground-subpanel">
                            
                            <!-- Comparison Header -->
                            <div class="comparison-header">
                                <div class="comparison-title">
                                    <h2><i class="fas fa-balance-scale"></i> Property Comparison Matrix</h2>
                                    <p class="comparison-subtitle">Compare up to 4 properties side-by-side to find your perfect match</p>
                                </div>
                                <div class="comparison-actions">
                                    <button class="btn-clear-comparison" onclick="clearComparison()">
                                        <i class="fas fa-trash"></i> Clear All
                                    </button>
                                    <button class="btn-export-comparison" onclick="exportComparison()">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                </div>
                            </div>

                            <!-- Property Selection Area -->
                            <div class="comparison-selection">
                                <h3><i class="fas fa-hand-pointer"></i> Select Properties to Compare</h3>
                                <p class="selection-hint">Choose 2-4 properties from the list below</p>
                                <div id="comparisonPropertyGrid" class="comparison-property-grid">
                                    <!-- Properties will be populated here -->
                                    <div class="comparison-placeholder">
                                        <i class="fas fa-search"></i>
                                        <p>Search for properties to start comparing</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Selected Properties Cards -->
                            <div id="selectedPropertiesContainer" class="selected-properties-container" style="display: none;">
                                <h3><i class="fas fa-check-circle"></i> Selected for Comparison (<span id="selectedCount">0</span>/4)</h3>
                                <div id="selectedPropertiesCards" class="selected-properties-cards">
                                    <!-- Selected property cards will appear here -->
                                </div>
                                <button class="btn-start-comparison" onclick="startComparison()">
                                    <i class="fas fa-play"></i> Start Comparison
                                </button>
                            </div>

                            <!-- Comparison Results -->
                            <div id="comparisonResults" class="comparison-results" style="display: none;">
                                
                                <!-- Overall Winner Banner -->
                                <div class="winner-banner">
                                    <div class="winner-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="winner-content">
                                        <h3>🏆 Overall Winner</h3>
                                        <div class="winner-property" id="overallWinner">
                                            <div class="winner-name">--</div>
                                            <div class="winner-score">Score: <span id="winnerScore">0</span>/100</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Comparison Table -->
                                <div class="comparison-table-container">
                                    <table class="comparison-table" id="comparisonTable">
                                        <thead>
                                            <tr>
                                                <th class="metric-column">Metric</th>
                                                <!-- Property columns will be added dynamically -->
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Rows will be populated dynamically -->
                                        </tbody>
                                    </table>
                                </div>

                                <!-- Visual Comparison Charts -->
                                <div class="comparison-charts">
                                    <div class="comparison-chart-card">
                                        <h4><i class="fas fa-chart-radar"></i> Property DNA (Radar Chart)</h4>
                                        <canvas id="radarComparisonChart" style="max-height: 400px;"></canvas>
                                    </div>
                                    
                                    <div class="comparison-chart-card">
                                        <h4><i class="fas fa-chart-bar"></i> Price Comparison</h4>
                                        <canvas id="priceComparisonChart" style="max-height: 300px;"></canvas>
                                    </div>
                                </div>

                                <!-- Recommendations -->
                                <div class="comparison-recommendations">
                                    <h3><i class="fas fa-lightbulb"></i> Smart Recommendations</h3>
                                    <div id="recommendationsGrid" class="recommendations-grid">
                                        <!-- Recommendations will be populated here -->
                                    </div>
                                </div>

                            </div>

                        </div>
                        <!-- End Property Comparison Matrix Sub-Panel -->

                        <!-- Property Battle Royale Sub-Panel -->
                        <div id="battle-panel" class="playground-subpanel">
                            
                            <!-- Battle Header -->
                            <div class="battle-header">
                                <div class="battle-title">
                                    <h2><i class="fas fa-trophy"></i> Property Battle Royale</h2>
                                    <p class="battle-subtitle">Tournament-style elimination - let properties battle until one champion emerges!</p>
                                </div>
                                <div class="battle-actions">
                                    <button class="btn-restart-tournament" onclick="restartTournament()" style="display: none;">
                                        <i class="fas fa-redo"></i> New Tournament
                                    </button>
                                </div>
                            </div>

                            <!-- Tournament Setup -->
                            <div id="battleSetup" class="battle-setup">
                                <div class="setup-card">
                                    <h3><i class="fas fa-users"></i> Setup Tournament</h3>
                                    <p>Select how many properties you want in the tournament:</p>
                                    
                                    <div class="tournament-size-options">
                                        <button class="size-option-btn" onclick="selectTournamentSize(4)" data-size="4">
                                            <div class="size-number">4</div>
                                            <div class="size-label">Properties</div>
                                            <div class="size-rounds">2 Rounds</div>
                                        </button>
                                        <button class="size-option-btn" onclick="selectTournamentSize(8)" data-size="8">
                                            <div class="size-number">8</div>
                                            <div class="size-label">Properties</div>
                                            <div class="size-rounds">3 Rounds</div>
                                        </button>
                                    </div>

                                    <div id="propertySelectionForBattle" class="property-selection-for-battle" style="display: none;">
                                        <h4>Select <span id="requiredPropertyCount">0</span> properties for the tournament:</h4>
                                        <p class="selection-count">Selected: <span id="battleSelectedCount">0</span>/<span id="battleRequiredCount">0</span></p>
                                        
                                        <div id="battlePropertyGrid" class="battle-property-grid">
                                            <!-- Properties populated here -->
                                        </div>

                                        <button class="btn-start-tournament" onclick="startTournament()" disabled>
                                            <i class="fas fa-play"></i> Start Tournament
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Tournament Arena -->
                            <div id="battleArena" class="battle-arena" style="display: none;">
                                
                                <!-- Current Round Info -->
                                <div class="round-info">
                                    <div class="round-badge" id="currentRoundBadge">Round 1</div>
                                    <div class="matchup-progress" id="matchupProgress">Matchup 1 of 4</div>
                                </div>

                                <!-- Head-to-Head Matchup -->
                                <div class="matchup-container">
                                    <div class="matchup-card left-property" id="leftProperty">
                                        <!-- Left property populated here -->
                                    </div>

                                    <div class="vs-divider">
                                        <div class="vs-circle">VS</div>
                                        <div class="vs-text">Choose Your Winner!</div>
                                    </div>

                                    <div class="matchup-card right-property" id="rightProperty">
                                        <!-- Right property populated here -->
                                    </div>
                                </div>

                                <!-- Tournament Bracket (collapsible) -->
                                <div class="bracket-section">
                                    <button class="btn-toggle-bracket" onclick="toggleBracket()">
                                        <i class="fas fa-sitemap"></i> <span id="bracketToggleText">Show Bracket</span>
                                    </button>
                                    <div id="tournamentBracket" class="tournament-bracket" style="display: none;">
                                        <!-- Bracket visualization populated here -->
                                    </div>
                                </div>

                            </div>

                            <!-- Champion Ceremony -->
                            <div id="championCeremony" class="champion-ceremony" style="display: none;">
                                <div class="confetti-container" id="confetti"></div>
                                
                                <div class="champion-content">
                                    <div class="champion-icon">
                                        <i class="fas fa-crown"></i>
                                    </div>
                                    <h2>🏆 Tournament Champion! 🏆</h2>
                                    
                                    <div class="champion-property" id="championProperty">
                                        <!-- Champion details populated here -->
                                    </div>

                                    <div class="champion-stats">
                                        <div class="stat-item">
                                            <div class="stat-label">Matchups Won</div>
                                            <div class="stat-value" id="championWins">0</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-label">Properties Defeated</div>
                                            <div class="stat-value" id="propertiesDefeated">0</div>
                                        </div>
                                    </div>

                                    <div class="champion-actions">
                                        <button class="btn-new-tournament" onclick="restartTournament()">
                                            <i class="fas fa-redo"></i> Start New Tournament
                                        </button>
                                        <button class="btn-view-bracket" onclick="viewFinalBracket()">
                                            <i class="fas fa-sitemap"></i> View Full Bracket
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- End Property Battle Royale Sub-Panel -->

                        <!-- Investment Score Dashboard Sub-Panel -->
                        <div id="scores-panel" class="playground-subpanel">
                            
                            <!-- Score Dashboard Header -->
                            <div class="score-header">
                                <div class="score-title">
                                    <h2><i class="fas fa-chart-bar"></i> Investment Score Dashboard</h2>
                                    <p class="score-subtitle">Every property gets a report card - see which ones make the Dean's List!</p>
                                </div>
                                <div class="score-legend">
                                    <span class="grade-badge grade-a">A</span>
                                    <span class="grade-badge grade-b">B</span>
                                    <span class="grade-badge grade-c">C</span>
                                    <span class="grade-badge grade-d">D</span>
                                    <span class="grade-badge grade-f">F</span>
                                </div>
                            </div>

                            <!-- Score Controls -->
                            <div class="score-controls">
                                <div class="score-filter-group">
                                    <label><i class="fas fa-filter"></i> Filter by Grade:</label>
                                    <select id="gradeFilter" onchange="filterByGrade()">
                                        <option value="all">All Grades</option>
                                        <option value="A">A Grade Only (Excellent)</option>
                                        <option value="B">B Grade & Above (Good+)</option>
                                        <option value="C">C Grade & Above (Average+)</option>
                                        <option value="D">D Grade & Above</option>
                                        <option value="F">Show All Including F</option>
                                    </select>
                                </div>
                                <div class="score-sort-group">
                                    <label><i class="fas fa-sort"></i> Sort by:</label>
                                    <select id="scoreSort" onchange="sortByScore()">
                                        <option value="score-desc">Highest Score First</option>
                                        <option value="score-asc">Lowest Score First</option>
                                        <option value="value-desc">Best Value First</option>
                                        <option value="location-desc">Best Location First</option>
                                        <option value="property-desc">Best Property First</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Dean's List Section -->
                            <div id="deansListSection" class="deans-list-section" style="display: none;">
                                <div class="deans-list-banner">
                                    <i class="fas fa-trophy"></i>
                                    <h3>🎓 Dean's List - Top 10% Properties</h3>
                                    <p>These properties scored in the top tier across all categories</p>
                                </div>
                                <div id="deansListGrid" class="deans-list-grid">
                                    <!-- Dean's list properties populated here -->
                                </div>
                            </div>

                            <!-- Score Summary Stats -->
                            <div class="score-summary">
                                <div class="summary-card">
                                    <div class="summary-icon"><i class="fas fa-star"></i></div>
                                    <div class="summary-content">
                                        <div class="summary-label">Average Score</div>
                                        <div class="summary-value" id="avgScore">0.0</div>
                                    </div>
                                </div>
                                <div class="summary-card">
                                    <div class="summary-icon"><i class="fas fa-award"></i></div>
                                    <div class="summary-content">
                                        <div class="summary-label">Top Score</div>
                                        <div class="summary-value" id="topScore">0.0</div>
                                    </div>
                                </div>
                                <div class="summary-card">
                                    <div class="summary-icon"><i class="fas fa-graduation-cap"></i></div>
                                    <div class="summary-content">
                                        <div class="summary-label">Grade Distribution</div>
                                        <div class="summary-value" id="gradeDistribution">-</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Scored Properties Grid -->
                            <div id="scoredPropertiesGrid" class="scored-properties-grid">
                                <!-- Scored property cards populated here -->
                            </div>

                            <!-- Score Detail Modal -->
                            <div id="scoreDetailModal" class="score-modal" style="display: none;">
                                <div class="score-modal-content">
                                    <button class="score-modal-close" onclick="closeScoreDetail()">
                                        <i class="fas fa-times"></i>
                                    </button>
                                    
                                    <div class="score-detail-header">
                                        <h3 id="scoreDetailTitle">Property Score Report</h3>
                                        <div id="scoreDetailGrade" class="score-detail-grade"></div>
                                    </div>

                                    <div class="score-detail-body">
                                        <div class="score-detail-overall">
                                            <div class="overall-score-circle">
                                                <div class="overall-score-number" id="scoreDetailOverall">0.0</div>
                                                <div class="overall-score-label">Overall Score</div>
                                            </div>
                                        </div>

                                        <div class="score-chart-container">
                                            <canvas id="scoreRadarChart"></canvas>
                                        </div>

                                        <div class="score-breakdown">
                                            <h4>Score Breakdown</h4>
                                            <div id="scoreBreakdownList" class="score-breakdown-list">
                                                <!-- Breakdown items populated here -->
                                            </div>
                                        </div>

                                        <div class="score-insights">
                                            <h4>💡 Insights</h4>
                                            <div id="scoreInsights" class="score-insights-content">
                                                <!-- Insights populated here -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- End Investment Score Dashboard Sub-Panel -->

                    </div>
                </div>
                <!-- End Playground Tab -->
            </div>
            <!-- End Tab Content -->
        </div>

        <div id="error" class="error-message" style="display: none;"></div>

        <div id="loading" class="loading-overlay" style="display: none;">
            <div class="loading-content">
                <div class="spinner-large"></div>
                <p>Loading property data...</p>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 Microburbs. Professional Property Intelligence Platform.</p>
            <p class="disclaimer">Data provided for informational purposes only. Always conduct your own due diligence.</p>
        </div>
    </footer>

    <script src="app.js"></script>
</body>
</html>

